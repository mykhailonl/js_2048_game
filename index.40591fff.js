!function(){function t(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function e(e,r){if(e){if("string"==typeof e)return t(e,r);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return t(e,r)}}function r(r){return function(e){if(Array.isArray(e))return t(e)}(r)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(r)||e(r)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var n,i={},a=new((n=/*#__PURE__*/function(){var t;function n(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];!function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}(this,n),t.length?this.initialState=t:this.initialState=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],this.status="idle",this.score=0,this.currentState=this.initialState.map(function(t){return r(t)})}return t=[{key:"isGameOver",value:function(){"lose"===this.getStatus()?document.querySelector(".message-lose").classList.remove("hidden"):"win"===this.getStatus()&&document.querySelector(".message-win").classList.remove("hidden")}},{key:"checkWinCondition",value:function(){return this.currentState.some(function(t){return t.includes(2048)})}},{key:"checkMovePossibility",value:function(){if(this.getEmptyCellsCoordinates().length>0)return!0;for(var t=0;t<4;t++)for(var e=0;e<4;e++){var r=this.checkCellByCoordinates([t,e]);if(e<3&&r===this.checkCellByCoordinates([t,e+1])||t<3&&r===this.checkCellByCoordinates([t+1,e]))return!0}return!1}},{key:"moveDown",value:function(){if("playing"===this.getStatus()){for(var t=JSON.stringify(this.currentState),e=3;e>=0;e--)for(var r=[!1,!1,!1,!1],n=3;n>=0;n--){var i=this.checkCellByCoordinates([n,e]);if(0!==i){for(var a=n,o=a+1;o<=3&&0===this.checkCellByCoordinates([o,e]);)this.currentState[o][e]=i,this.currentState[a][e]=0,a=o,o++;o<=3&&this.checkCellByCoordinates([o,e])===i&&!r[o]&&(this.currentState[o][e]*=2,this.currentState[a][e]=0,this.score+=this.currentState[o][e],r[o]=!0)}}t===JSON.stringify(this.currentState)||(this.checkWinCondition()&&(this.status="win"),this.generateAndPositionNewTile(),this.updateTheBoard(),this.checkMovePossibility()||(this.status="lose"))}}},{key:"moveUp",value:function(){if("playing"===this.getStatus()){for(var t=JSON.stringify(this.currentState),e=0;e<4;e++)for(var r=[!1,!1,!1,!1],n=0;n<4;n++){var i=this.checkCellByCoordinates([n,e]);if(0!==i){for(var a=n,o=a-1;o>=0&&0===this.checkCellByCoordinates([o,e]);)this.currentState[o][e]=i,this.currentState[a][e]=0,a=o,o--;o>=0&&this.checkCellByCoordinates([o,e])===i&&!r[o]&&(this.currentState[o][e]*=2,this.currentState[a][e]=0,this.score+=this.currentState[o][e],r[o]=!0)}}t===JSON.stringify(this.currentState)||(this.checkWinCondition()&&(this.status="win"),this.generateAndPositionNewTile(),this.updateTheBoard(),this.checkMovePossibility()||(this.status="lose"))}}},{key:"moveLeft",value:function(){var t=this;if("playing"===this.getStatus()){for(var e=JSON.stringify(this.currentState),n=0;n<4;n++)!function(e){var n=t.currentState[e].filter(function(t){return 0!==t});n=r(n).concat(r(Array(4-n.length).fill(0))),t.currentState[e]=n;for(var i=[!1,!1,!1,!1],a=0;a<3;a++){var o=t.checkCellByCoordinates([e,a]);0===o||t.checkCellByCoordinates([e,a+1])!==o||i[a]||(t.currentState[e][a]*=2,t.currentState[e][a+1]=0,t.score+=t.currentState[e][a],i[a]=!0)}n=r(n=t.currentState[e].filter(function(t){return 0!==t})).concat(r(Array(4-n.length).fill(0))),t.currentState[e]=n}(n);e===JSON.stringify(this.currentState)||(this.checkWinCondition()&&(this.status="win"),this.generateAndPositionNewTile(),this.updateTheBoard(),this.checkMovePossibility()||(this.status="lose"))}}},{key:"moveRight",value:function(){var t=this;if("playing"===this.getStatus()){for(var e=JSON.stringify(this.currentState),n=0;n<4;n++)!function(e){var n=t.currentState[e].filter(function(t){return 0!==t});n=r(Array(4-n.length).fill(0)).concat(r(n)),t.currentState[e]=n;for(var i=[!1,!1,!1,!1],a=3;a>0;a--){var o=t.checkCellByCoordinates([e,a]);0===o||t.checkCellByCoordinates([e,a-1])!==o||i[a]||(t.currentState[e][a]*=2,t.currentState[e][a-1]=0,t.score+=t.currentState[e][a],i[a]=!0)}n=r(Array(4-(n=t.currentState[e].filter(function(t){return 0!==t})).length).fill(0)).concat(r(n)),t.currentState[e]=n}(n);e===JSON.stringify(this.currentState)||(this.checkWinCondition()&&(this.status="win"),this.generateAndPositionNewTile(),this.updateTheBoard(),this.checkMovePossibility()||(this.status="lose"))}}},{key:"updateTheScore",value:function(){document.querySelector(".game-score").innerText=this.score}},{key:"getScore",value:function(){return this.score}},{key:"getState",value:function(){return this.currentState}},{key:"getStatus",value:function(){return this.status}},{key:"generateAndPositionNewTile",value:function(){this.positionNewTile(this.generateNewTile())}},{key:"initializeBoard",value:function(){this.generateAndPositionNewTile(),this.generateAndPositionNewTile()}},{key:"start",value:function(){this.status="playing",this.initializeBoard(),this.updateTheBoard()}},{key:"restart",value:function(){this.score=0,this.status="idle",this.currentState=this.initialState.map(function(t){return r(t)}),this.updateTheBoard()}},{key:"resetTheField",value:function(){var t=this.getNonEmptyCells(),e=this.getState();t.forEach(function(t){e[t[0]][t[1]]=0}),this.updateTheBoard()}},{key:"generateNewTile",value:function(){return .1>Math.random()?4:2}},{key:"positionNewTile",value:function(t){var e=this.getEmptyCellsCoordinates(),r=e[Math.floor(Math.random()*e.length)];e.length?this.getState()[r[0]][r[1]]=t:this.checkMovePossibility()}},{key:"getEmptyCellsCoordinates",value:function(){for(var t=[],e=0;e<this.getState().length;e++)for(var r=0;r<this.getState()[e].length;r++)0===this.currentState[e][r]&&t.push([e,r]);return t}},{key:"getNonEmptyCells",value:function(){for(var t=[],e=0;e<this.getState().length;e++)for(var r=0;r<this.getState()[e].length;r++)0!==this.currentState[e][r]&&t.push([e,r]);return t}},{key:"checkCellByCoordinates",value:function(t){var r=function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r,n,i=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=i){var a=[],o=!0,s=!1;try{for(i=i.call(t);!(o=(r=i.next()).done)&&(a.push(r.value),2!==a.length);o=!0);}catch(t){s=!0,n=t}finally{try{o||null==i.return||i.return()}finally{if(s)throw n}}return a}}(t,2)||e(t,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),n=r[0],i=r[1];return n>=0&&n<4&&i>=0&&i<4?this.currentState[n][i]:null}},{key:"updateTheBoard",value:function(){var t=r(document.querySelectorAll("tr.field-row")),e=this.currentState;if(0!==t.length)for(var n=0;n<e.length;n++)for(var i=0;i<e[n].length;i++){var a=t[n].children[i],o=e[n][i];a.className="field-cell",0!==o?(a.classList.add("field-cell--".concat(o)),a.innerText=o):a.innerText=""}}}],function(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}(n.prototype,t),n}())&&n.__esModule?n.default:n),o=function(t){t.classList.remove("start"),t.classList.add("restart"),t.innerText="Restart"},s=function(){r(document.querySelectorAll(".message")).forEach(function(t){return t.classList.add("hidden")})};document.addEventListener("DOMContentLoaded",function(){var t=document.querySelector(".button");t&&t.addEventListener("click",function(){"idle"===a.getStatus()?(a.start(),o(t),s()):"playing"===a.getStatus()?(a.restart(),a.start()):"lose"===a.getStatus()&&(a.restart(),a.start(),s())})}),document.addEventListener("keydown",function(t){if(["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"].includes(t.key)&&t.preventDefault(),"playing"===a.getStatus()){switch(t.key){case"ArrowUp":a.moveUp();break;case"ArrowDown":a.moveDown();break;case"ArrowLeft":a.moveLeft();break;case"ArrowRight":a.moveRight()}("win"===a.getStatus()||"lose"===a.getStatus())&&a.isGameOver(),a.updateTheScore(),a.updateTheBoard()}})}();
//# sourceMappingURL=index.40591fff.js.map
